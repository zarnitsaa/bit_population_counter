module bit_population_counter #(

parameter int WIDTH

(
input wire clk_i,
input wire srst_i,
input reg [WIDTH:0] data_i,
input wire data_val_i,
output reg [@clog2(WIDTH)+1:0] data_i,
output wire data_val_o
);

local param int WIDTH=$clog2(data_i);
assign data_val_o=data_val_i;
always@(posedge_clk_i)

begin
	if (srst_i)
		data_o<='0;
		data_val_o<=0;
	else if (data_val_i)
		do begin
			data_o=data_o+data_i[WIDTH];
			WIDTH=WIDTH-1;
		end while [WIDTH==0];
	else
		data_o<=1'b0;
end
endmodule